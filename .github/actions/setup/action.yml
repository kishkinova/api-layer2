name: "Setup action"
description: "Prepares for execution - checkout, set up Java, Node, npm, Gradle"

runs:
    using: "composite"
    steps:
        -   uses: actions/checkout@v2
            with:
              ref: ${{ github.head_ref }}
        -   name: Set up JDK 1.8
            uses: actions/setup-java@v1
            with:
                java-version: 1.8
        -   name: Set up Node
            uses: actions/setup-node@v2
            with:
                node-version: '14'
        -   run: npm install -g npm@8.1.0
        -   name: Grant execute permission for gradlew
            run: chmod +x gradlew
        -   name: Cache Gradle packages
            uses: actions/cache@v2
            with:
                path: |
                    ~/.gradle/caches
                    ~/.gradle/wrapper
            key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}

        -   name: Cache Node.js modules
            uses: actions/cache@v2
            with:
                path: |
                    ~/.npm
                    **/node_modules
            key: ${{ runner.OS }}-node-${{ hashFiles('**/package-lock.json', '**/package.json') }}
