buildscript {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
    dependencies {
        classpath libs.gradle.tomcat.plugin
    }
}

plugins {
    alias(libs.plugins.gradle.tomcat)
}

apply plugin: 'java'
apply plugin: 'war'

repositories {
    mavenCentral()
}

dependencies {
    implementation project(':onboarding-enabler-java')

    implementation libs.swagger.jaxrs2

    compileOnly libs.javax.servlet.api
    implementation(libs.jackson.dataformat.yaml) {
        exclude group: "org.yaml", module: "snakeyaml"
    }
    implementation libs.snakeyaml

    compileOnly libs.lombok
    annotationProcessor libs.lombok

    implementation libs.jersey.server
    implementation libs.jersey.hk2
    implementation libs.jersey.container.servlet.core
    implementation libs.jersey.media.json.jackson

    testImplementation libs.jersey.test.provider.jdk.http
    testImplementation libs.spring4Test
    testImplementation libs.mockito.core
    testImplementation libs.json.path

    tomcat libs.tomcat.embed.core.get(),
            libs.tomcat.embed.logging.juli.get(),
            libs.tomcat.embed.jasper.get()
}

tomcat {
    httpsPort = 10016
    ajpPort = 8009
    stopPort = 8081
    contextPath = '/'
    enableSSL = true
    tomcatRun.keystoreFile = file("${project.rootDir}/keystore/localhost/localhost.keystore.p12")
    tomcatRun.truststoreFile = file("${project.rootDir}/keystore/localhost/localhost.truststore.p12")
    tomcatRun.keystorePass = "password"
    tomcatRun.truststorePass = "password"
    httpProtocol = 'org.apache.coyote.http11.Http11Nio2Protocol'
    ajpProtocol  = 'org.apache.coyote.ajp.AjpNio2Protocol'
}
